---
title: CVE-2021-42171【文件上传】
author: Ghost
date: 2023-12-10
categories:
  - ['春秋云境', '漏洞靶标']
  - 漏洞复现
tags:
  - '文件上传'
---

## 1. 漏洞介绍

[阿里云漏洞库](https://avd.aliyun.com/detail?id=AVD-2021-42171)

## 2. 漏洞复现

[File upload to Remote Code Execution on Zenario CMS 9.0.54156 | by Minh Quang Nguyen | Medium](https://minhnq22.medium.com/file-upload-to-rce-on-zenario-9-0-54156-cms-fa05fcc6cf74)

[Zenario CMS 9.0.54156 Remote Code Execution ≈ Packet Storm](https://packetstormsecurity.com/files/166617/Zenario-CMS-9.0.54156-Remote-Code-Execution.html)

访问 `http://eci-2……a.cloudeci1.ichunqiu.com/admin.php` 以admin登录，burp suite抓包爆破即可【admin/Aa123456】，登录后上传文件

![1.png](https://fastly.jsdelivr.net/gh/z9m8r8/PicGo-Notes-Pu/202309261719476.png)

写个一句话木马，文件后缀改成允许上传的类型，如txt,docx等

![2.png](https://fastly.jsdelivr.net/gh/z9m8r8/PicGo-Notes-Pu/202309261720339.png)

![3.png](https://fastly.jsdelivr.net/gh/z9m8r8/PicGo-Notes-Pu/202309261720764.png)

修改上传文件的后缀，由于没法直接修改，可借助 `Editing metadata` 完成，操作如下

![4.png](https://fastly.jsdelivr.net/gh/z9m8r8/PicGo-Notes-Pu/202309261720498.png)

点击 `save` ，并用burp suite抓包， 将文件后缀 txt 改成 php，forward

![5.png](https://fastly.jsdelivr.net/gh/z9m8r8/PicGo-Notes-Pu/202309261721665.png)

获取文件地址，并用蚁剑连接获取 flag

![6.png](https://fastly.jsdelivr.net/gh/z9m8r8/PicGo-Notes-Pu/202309261725122.png)


![flag.png](https://fastly.jsdelivr.net/gh/z9m8r8/PicGo-Notes-Pu/202309261721054.png)
