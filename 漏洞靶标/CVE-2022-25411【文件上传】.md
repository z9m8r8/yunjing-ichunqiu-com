---
title: CVE-2022-25411【文件上传】
author: Ghost
date: 2023-12-10
categories:
  - ['春秋云境', '漏洞靶标']
  - 漏洞复现
tags:
  - '文件上传'
---

## 1. 漏洞介绍

MaxSite CMS是俄国MaxSite CMS开源项目的一款网站内容管理系统。马克斯程序(MaxCMS)以开源、免费、功能强大、安全健壮、性能卓越、超级易用、模板众多、插件齐全等优势，受到众多企业和站长的喜爱。马克斯程序研发团队拥有多年的技术积累和产品开发经验，成立了官方技术支持团队、官方模板团队、官方插件团队。一切立足于站长利益、孜孜不倦的挖掘站长需求、不断提升产品体验，自主创新多项特色技术、提升网站品质!独立开发的管理员管理系统，可以对管理员进行更能人性化的管理网站。 Maxsite CMS存在文件上传漏洞，攻击者可利用该漏洞通过精心制作的PHP文件执行任意代码。账户为弱口令。

## 2. 漏洞复现

POC：[Remote Code Execution Vulnerability In MaxSite CMS v180 · Issue #487 · maxsite/cms · GitHub](https://github.com/maxsite/cms/issues/487)

由于漏洞点在 admin/options 下，所以我们需要进入站点后台，为此利用 **dirsearch** 等工具扫描登录地址。

- 示例

```bash
┌──(root㉿kali)-[~]
└─# dirsearch -u "http://39.106.48.123:44194/"
```

先安装【不要跳过这步，不然访问admin会出现404】

![2.png](https://fastly.jsdelivr.net/gh/z9m8r8/PicGo-Notes-Pu/202310102257898.png)

![3.png](https://fastly.jsdelivr.net/gh/z9m8r8/PicGo-Notes-Pu/202310102257729.png)

burpsuite 抓包爆破 —— admin/admin888

添加可上传类型：php

![4.png](https://fastly.jsdelivr.net/gh/z9m8r8/PicGo-Notes-Pu/202310102258237.png)

上传 shell 蚁剑连接获取 flag

![5.png](https://fastly.jsdelivr.net/gh/z9m8r8/PicGo-Notes-Pu/202310102259484.png)

![6.png](https://fastly.jsdelivr.net/gh/z9m8r8/PicGo-Notes-Pu/202310102300720.png)

![7.png](https://fastly.jsdelivr.net/gh/z9m8r8/PicGo-Notes-Pu/202310102304763.png)
