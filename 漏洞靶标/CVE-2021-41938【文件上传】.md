---
title: CVE-2021-41938【文件上传】
author: Ghost
date: 2023-12-10
categories:
  - ['春秋云境', '漏洞靶标']
  - 漏洞复现
tags:
  - '文件上传'
---

## 1. 漏洞介绍

ShopXO CMS 2.2.0. 后台管理页面存在任意文件上传漏洞

## 2. 漏洞分析

[After entering the management page，there is an arbitrary file upload vulnerability in 3 locations · Issue #64 · gongfuxiang/shopxo · GitHub](https://github.com/gongfuxiang/shopxo/issues/64)

## 3. 漏洞复现

在shopxo官网下载个主题或者到下面网盘直接下载

> 链接: [https://pan.baidu.com/s/1vLLIlOvr9dkwZ6-Orgj97Q](https://pan.baidu.com/s/1vLLIlOvr9dkwZ6-Orgj97Q)

> 提取码: jb48

修改下载的主题，在其中加入一句话木马，文件格式为 `phtml`

![1.png](https://fastly.jsdelivr.net/gh/z9m8r8/PicGo-Notes-Pu/202311221955433.png)


访问 `http://eci-………………1.ichunqiu.com/admin.php?s=admin/logininfo.html` ，登录后台，admin/shopxo，上传主题并启用

![2.png](https://fastly.jsdelivr.net/gh/z9m8r8/PicGo-Notes-Pu/202311221955605.png)

蚁剑连接，路径如下：  

`http://eci-2…………n.cloudeci1.ichunqiu.com/public/static/index/shell/shell.phtml`   

注意，后面路径根据木马自己放的位置来改，如……/shell/css/shell.phtml

![3.png](https://fastly.jsdelivr.net/gh/z9m8r8/PicGo-Notes-Pu/202311221956452.png)

读取 flag  

![4.png](https://fastly.jsdelivr.net/gh/z9m8r8/PicGo-Notes-Pu/202311221956954.png)
