## 1. 漏洞介绍
[阿里云漏洞库](https://avd.aliyun.com/detail?id=AVD-2021-44238)
AyaCms是一款极其简单且自由的PHP建站系统，支持模板可视化,标签可视化操作.拖拽排版,所见即所得; 支持电脑,移动设备,微信个性设置; 支持多语言建站; 支持自定义表单; 其3.1.2版本在后台修改模板处存在任意代码写入进而导致RCE.
## 2. 漏洞复现
根据漏洞介绍可知漏洞利用需以admin登录后台，所以先进行目录遍历获取后台登陆地址，dirsearch 遍历得`http://………….cloudeci1.ichunqiu.com/admin.php?action=login`，手动测试 admin 用户弱口令登录，密码没试出来，但发现验证码机制是无效的，直接 burp suite 抓包爆破！成功拿到password：`adminadmin`
![1.png](https://fastly.jsdelivr.net/gh/z9m8r8/PicGo-Notes-Pu/202309201139107.png)

登录后台，修改/aya/module/admin/ust_tab_e.inc.php实现RCE【试了下同目录下其他php也可以实现】，写个一句话用蚁剑连接获取 flag。

![2.png](https://fastly.jsdelivr.net/gh/z9m8r8/PicGo-Notes-Pu/202309201146651.png)

![2.png](https://fastly.jsdelivr.net/gh/z9m8r8/PicGo-Notes-Pu/202309201146652.png)
**注**，蚁剑连接所用地址`http://eci-……………….ichunqiu.com/aya/module/admin/ust_tab_e.inc.php`
![2.png](https://fastly.jsdelivr.net/gh/z9m8r8/PicGo-Notes-Pu/202309201146654.png)

![5.png](https://fastly.jsdelivr.net/gh/z9m8r8/PicGo-Notes-Pu/202309201147787.png)
