---
title: CVE-2022-32992【SQL 注入】
author: Ghost
date: 2023-12-10
categories:
  - ['春秋云境', '漏洞靶标']
  - 漏洞复现
tags:
  - 'SQL 注入'
---

## 1. 漏洞介绍

该CMS的 admin/operations/tax.php中存在可控的INSERT 语句参数，从而导致了SQL注入攻击。

## 2. 漏洞复现

### 2.1. 方案一：不登录的情况下

SQL 注入点是在 admin/operations/tax.php页面，直接访问会重定向到登录页，为此得想法子绕过，对站点进行信息收集，通过目录遍历发现个有用页面

![2.jpg](https://fastly.jsdelivr.net/gh/z9m8r8/PicGo-Notes-Pu/202309011731824.jpg)

经测试，发现能直接上传 webshell，传马蚁剑连接

![3.jpg](https://fastly.jsdelivr.net/gh/z9m8r8/PicGo-Notes-Pu/202309011731442.jpg)

![4.jpg](https://fastly.jsdelivr.net/gh/z9m8r8/PicGo-Notes-Pu/202309011733077.jpg)

修改要访问的文件，将涉及重定向的代码注释掉，然后用sqlmap直接跑

![5.jpg](https://fastly.jsdelivr.net/gh/z9m8r8/PicGo-Notes-Pu/202309011735478.jpg)

![6.jpg](https://fastly.jsdelivr.net/gh/z9m8r8/PicGo-Notes-Pu/202309011735572.jpg)

……拿到 flag

![7.jpg](https://fastly.jsdelivr.net/gh/z9m8r8/PicGo-Notes-Pu/202309011736420.jpg)

### 2.2. 方案二：登录的情况下

谷歌找到个 [SQLi-3.md](https://github.com/songbingxue/Bug_report/blob/main/vendors/mayuri_k/online-tours-travels-management-system/SQLi-3.md) 测试[mayuri.infospace@gmail.com](mailto:mayuri.infospace@gmail.com)/admin发现能登录进去，后续直接用burp suite 抓包，sqlmap post 注入即可。

参考：[春秋云镜靶场CVE-2022-32992 - nLesxw - 博客园](https://www.cnblogs.com/nLesxw/p/cve1.html)
