## 1. 漏洞介绍
[Server Side Template Injection vulnerability found in grav](https://huntr.dev/bounties/3ef640e6-9e25-4ecb-8ec1-64311d63fe66/)
[Twig allowing dangerous PHP functions by default · Advisory · getgrav/grav · GitHub](https://github.com/getgrav/grav/security/advisories/GHSA-g8r4-p96j-xfxc)
Grav CMS 可以通过 Twig 来进行页面的渲染，使用了不安全的配置可以达到远程代码执行的效果，影响最新版 v1.7.34 以下的版本
## 2. 漏洞复现
注意，创建账户时password要求：大写字母+小写字母+数字且长度>=8位

- **漏洞点测试**

![1.png](https://fastly.jsdelivr.net/gh/z9m8r8/PicGo-Notes-Pu/202310051643146.png)

**效果**

![2.png](https://fastly.jsdelivr.net/gh/z9m8r8/PicGo-Notes-Pu/202310051644743.png)

- **读取 flag**

![3.png](https://fastly.jsdelivr.net/gh/z9m8r8/PicGo-Notes-Pu/202310051645398.png)

![4.png](https://fastly.jsdelivr.net/gh/z9m8r8/PicGo-Notes-Pu/202310051646022.png)
