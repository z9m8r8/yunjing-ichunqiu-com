## 1. 漏洞介绍
WordPress plugin The WP Visitor Statistics (Real Time Traffic) 5.6 之前存在SQL注入漏洞，该漏洞源于 refUrlDetails AJAX 不会清理和转义 id 参数。
该插件在通过 refUrlDetails AJAX 操作在 SQL 语句中使用 id 参数之前不会对其进行清理和转义，任何经过身份验证的用户都可以使用它，从而导致 SQL 注入
> 参考信息：
> [WP Visitor Statistics (Real Time Traffic) < 5.6 - Subscriber+ SQL Injection](https://wpscan.com/vulnerability/0d6b89f5-cf12-4ad4-831b-fed26763ba20)
> [WordPress The WP Visitor Statistics Plugin SQL注入漏洞](https://www.cnvd.org.cn/flaw/show/CNVD-2022-19792)

## 2. 影响版本
WordPress The WP Visitor Statistics Plugin <5.6

## 3. 漏洞复现
懒得手测了，直接用 sqlmap 跑吧，漏洞要先进行身份验证后才能利用，所以先登录抓包，再用sqlmap post注入，可以按常规的步骤来，dbs—>tables—>columns……就是有点慢，也可以用 `python sqlmap.py -r "post.txt" --sql-shell` 先拿个sql-shell，再用`select flag from flag` 获取 flag。

![1.jpg](https://fastly.jsdelivr.net/gh/z9m8r8/PicGo-Notes-Pu/202308291041554.jpg)

补充一点，如果权限足够也可以用 `python sqlmap.py -r xxx.txt --file-read "/flag" --dbms mysql --batch`  尝试直接读取