---
title: CVE-2022-23134【RCE】
author: Ghost
date: 2023-12-10
categories:
  - ['春秋云境', '漏洞靶标']
  - 漏洞复现
tags:
  - 'RCE'
---

## 1. 漏洞介绍

[CVE-2022-23131：Zabbix - A Case Study of Unsafe Session Storage - Defense.One](https://defense.one/d/56-cve-2022-23131zabbix-a-case-study-of-unsafe-session-storage)

Zabbix Sia Zabbix是拉脱维亚Zabbix SIA（Zabbix Sia）公司的一套开源的监控系统。该系统支持网络监控、服务器监控、云监控和应用监控等。 Zabbix 存在安全漏洞，该漏洞源于在初始设置过程之后，setup.php 文件的某些步骤不仅可以由超级管理员访问，也可以由未经身份验证的用户访问。

## 2. 漏洞复现

题目本意是绕过验证机制访问 setup.php 重写数据库配置，重置管理员 Admin 账号，最终可登录 Zabbix 并获取 flag。具体操作可参见：[Zabbix setup.php 访问权限控制不当漏洞(CVE-2022-23134)](https://mp.weixin.qq.com/s?__biz=Mzg4NTc1NTQ4NA==&mid=2247483687&idx=1&sn=df2fa6c44236951518a3d4c21d0ae703&chksm=cfa55a14f8d2d3027c99b73e9a83d840f73bbb15e050517ee848e965d98f823b33ae877afa81&scene=126&sessionid=1648597138&subscene=207&key=6cf53cb0132dda319eb0f673c12eb53fe67d45a8601792ce6d7e83be0634aa73e61e7ea0c65b7a713c367f2657f5f694cf89d4f8e5dfdbaf2dc7c2e16b873a992b006145fc4a141112cedfba63de9b063dbb51613cde0cce4a82d962cea708e5488c9bc4b445dae39b2add226f7c58a34ee7672d163f09283aa8942a8ac785e9&ascene=0&uin=MTM1NzU2MDQ1OQ%3D%3D&devicetype=Windows+Server+2016+x64&version=6305002e&lang=zh_CN&exportke)【`{"step":6}`->base64->`eyJzdGVwIjo2fQ==`】如果仅想获取本题 flag 可直接以 `Admin/zabbix` 登录操作……

![1.png](https://fastly.jsdelivr.net/gh/z9m8r8/PicGo-Notes-Pu/202310132046022.png)

任选一个将命令改成 `cat /flag` 

![2.png](https://fastly.jsdelivr.net/gh/z9m8r8/PicGo-Notes-Pu/202310132046731.png)

![3.png](https://fastly.jsdelivr.net/gh/z9m8r8/PicGo-Notes-Pu/202310132046076.png)

![4.png](https://fastly.jsdelivr.net/gh/z9m8r8/PicGo-Notes-Pu/202310132046988.png)

**参考**

[Zabbix漏洞](https://www.ddosi.org/cve-2022-23131/#CVE-2022-23134_%E2%80%93_%E9%87%8D%E6%96%B0%E9%85%8D%E7%BD%AE%E5%AE%9E%E4%BE%8B)

[GitHub - kh4sh3i/CVE-2022-23131: Zabbix - SAML SSO Authentication Bypass](https://github.com/kh4sh3i/CVE-2022-23131/tree/main)
