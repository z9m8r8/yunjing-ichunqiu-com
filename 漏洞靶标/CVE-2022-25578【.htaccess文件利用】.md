---
title: CVE-2022-25578【.htaccess文件利用】
author: Ghost
date: 2023-12-10
categories:
  - ['春秋云境', '漏洞靶标']
  - 漏洞复现
tags:
  - '.htaccess文件利用'
---

## 1. 漏洞介绍

- TaoCMS是一个完善支持多数据库(Sqlite/Mysql)的CMS网站内容管理系统。  

- TaoCMS存在代码注入漏洞，攻击者可利用该漏洞通过任意编辑.htaccess文件来执行代码注入，执行恶意代码或写入webshell等恶意代码。

## 2. 影响版本

- TaoCMS taoCMS 3.0.2

## 3. 漏洞复现

- 开启环境访问首页，通过右下角管理进入后台登录界面，看了下源码提示默认 `username/password=admin/tao` ，登录进后台，界面如下

![CVE-2022-25578-Picture-1.jpg](https://fastly.jsdelivr.net/gh/z9m8r8/PicGo-Notes-Pu/CVE-2022-25578-Picture-1.jpg)

- 尝试新建 shell 失败，测试访问 php 文件能否被执行【如 http://eci-2ze2u0b2wu2g8w3mp1n1.cloudeci1.ichunqiu.com/index.php 】，成功！

- 在index.php中写入木马并用中国蚁剑连接

![CVE-2022-25578-Picture-2.jpg](https://fastly.jsdelivr.net/gh/z9m8r8/PicGo-Notes-Pu/CVE-2022-25578-Picture-2.jpg)

![CVE-2022-25578-Picture-3.jpg](https://fastly.jsdelivr.net/gh/z9m8r8/PicGo-Notes-Pu/CVE-2022-25578-Picture-3.jpg)

- 拿到 flag

![CVE-2022-25578-Picture-4.jpg](https://fastly.jsdelivr.net/gh/z9m8r8/PicGo-Notes-Pu/CVE-2022-25578-Picture-4.jpg)

当然也可按照题目本意修改 .htaccess 文件来实现，如在 .htaccess 文件中添加 `SetHandler application/x-httpd-php` 以实现将当前目录及子目录下的所有文件解析为 PHP 文件，接着可以修改非 PHP 文件【如在README.md中添加木马】或上传 shell.jpg【添加文章处可上传】等用蚁剑来连接获取 flag 。
