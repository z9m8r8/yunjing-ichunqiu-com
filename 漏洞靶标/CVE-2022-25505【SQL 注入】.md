## 1. 漏洞介绍
[阿里云漏洞库](https://avd.aliyun.com/detail?id=AVD-2022-25505)
## 2. 漏洞分析
[taocms3.0.2 SQL injection exists in the background · Issue #27 · taogogo/taocms · GitHub](https://github.com/taogogo/taocms/issues/27)
## 3. 漏洞复现
弱口令登录：admin/tao
![1.jpg](https://fastly.jsdelivr.net/gh/z9m8r8/PicGo-Notes-Pu/202309061659168.jpg)

提交并用 burpsuite 抓包
![2.jpg](https://fastly.jsdelivr.net/gh/z9m8r8/PicGo-Notes-Pu/202309061659591.jpg)

![3.jpg](https://fastly.jsdelivr.net/gh/z9m8r8/PicGo-Notes-Pu/202309061701006.jpg)

sqlmap post 注入，经测试，常规注入没找到flag表，直接尝试从根目录读取 flag
![4.jpg](https://fastly.jsdelivr.net/gh/z9m8r8/PicGo-Notes-Pu/202309061713960.jpg)

```bash
	python sqlmap.py -r post.txt --file-read "/flag" --dbms mysql --batch
```
- file-read: SQLmap --file-read从服务器中读取文件
- 当用户权限足够大并且具有特定的函数，即可读取服务器中的文件，可以是文本，也可以是二进制文件
![5.jpg](https://fastly.jsdelivr.net/gh/z9m8r8/PicGo-Notes-Pu/202309061713533.jpg)

